<!DOCTYPE html>
<html>
  <head>
      <link rel="shortcut icon" href="http://www.freme-project.eu/wp-content/themes/vantage-child-01/favicon.png" />
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>FREME Documentation - Rate Limiting</title>
    <meta name="description" content="This site contains the documentation of the FREME project. The API documentation shows how to use FREMEs API. FREME showroom displays FREME in action. It contains demos, videos and other material to show what FREME can do. The tutorials section shows the capabilities of FREME and explains how to do certain things with the API. Knowledge Base contains a series of articles about FREME. Further there is page about License and Contact.">

  
	<link rel="stylesheet" href="/doc/css/bootstrap.min.css">
	<link rel="stylesheet" href="/doc/css/style.css">
	<link rel="stylesheet" href="/doc/css/overwrite.css">
	<link rel="canonical" href="http://api-dev.freme-project.eu/docknowledge-base/rate-limiting.html">
	<link rel="alternate" type="application/rss+xml" title="FREME Documentation" href="http://api-dev.freme-project.eu/doc/feed.xml" />
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
	<script src=/doc/js/bootstrap.min.js
	></script>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<script type="text/javascript">
		var fremeApiUrl= "http://api-dev.freme-project.eu/current";
	</script>
  </head>
  <body>

    <div class = "navbar navbar-default navbar-static-top">
	<div class = "container">
	
		<div class = "navbar-header">
								
			<button class = "navbar-toggle" data-toggle = "collapse" data-target = ".navHeaderCollapse">
				<span class = "icon-bar"></span>
				<span class = "icon-bar"></span>
				<span class = "icon-bar"></span>
			</button>
			<a href="/doc/home.html"><img src=/doc/img/Logo_FREME_icona_vert.png alt="FREME Logo" class = "navbar-logo"></a>
			<!-- <a href = "#" class = "navbar-brand">FREME Documentation</a> -->
		</div>
			
			<div class = "collapse navbar-collapse navHeaderCollapse">
			
				<ul class = "nav navbar-nav navbar-left">
			
			
			
			
			</ul>
			
		</div>
		
	</div>
</div>


	<div class = "container">
		<div class="post">

  <article class="post-content">
    <h3 id="rate-limiting">Rate Limiting</h3>
<p>Using the Rate-Limiting Filter one can limit the amount of requests as well as the size of all requests made by one user.
Unauthenticated users are mapped to their IP-Address, Authenticated users to their username.</p>

<h2 id="parameters-in-applicationproperties">Parameters in application.properties</h2>

<ul>
  <li><code>ratelimiter.enabled</code> - When set to <code>true</code>, the RateLimitingFilter will be enabled. This parameter defaults to <code>false</code>, and when it is not set (or explicitly set to <code>false</code>) all other parameters and options regarding this filter will have no effect.</li>
  <li><code>ratelimiter.clear.timer</code> - specifies time in miliseconds until all stored timestamps/sizes of previous requests will be deleted. Defaults to <code>3600000</code> which clears the filter once every hour.</li>
  <li><code>ratelimiter.yaml</code> - specifies path to ratelimiter.yaml configuration file used. Defaults to <code>src/main/resources/ratelimiter.yaml</code></li>
</ul>

<h2 id="parameters-in-ratelimiteryaml">Parameters in ratelimiter.yaml</h2>

<p>The <code>ratelimiter.yaml</code> file is a configuration file in the <a href="https://de.wikipedia.org/wiki/YAML">YAML</a> syntax which defines the exact limits for each group of users.
An example <code>ratelimiter.yaml</code> could look like this:</p>

<p><code>
time-frame: 600   # time period in seconds
rate-limits:
ROLE_ANONYMOUS:
    default:
        - 50
        - 10000 # anomyous user has 50 requests or 1000 kb in the time period
    /e-entity/freme-ner/datasets:
       - 10
        - 1000000 # override for anonymous user to allow 50 requests or 1 000 000 characters in the time period
ROLE_USER:
    default:
        - 100
       - 100000 # anomyous user has 50 requests or 1000 kb in the time period
    /e-entity/freme-ner/datasets:
       - 50
       - 2000000 # override for authenticated users to allow 50 requests or 2 000 000 characters in the time period
ROLE_ADMIN:
    default:
      - 0
       - 0 # admin user has no rate limits configured
henry:
    /e-translation/tilde:
       - 50
       - 100000 # user henry has a special override on tilde
</code></p>

<p>Every request will attempt to match one of these properties in the following order:</p>

<ol>
  <li><code>ratelimits.&lt;username-or-ip&gt;.&lt;requested-endpoint&gt;</code></li>
  <li><code>ratelimits.&lt;username-or-ip&gt;.default</code></li>
  <li><code>ratelimits.&lt;role-of-caller&gt;.&lt;requested-endpoint&gt;</code></li>
  <li><code>ratelimits.&lt;role-of-caller&gt;.default</code></li>
  <li>Throw internal server error <code>"No identifier found for "+&lt;username-or-ip&gt;+"with role"+ &lt;role-of-caller&gt; + "for resource" + &lt;requested-endpoint&gt;</code></li>
</ol>

<p>To ensure safe behaviour, the usernames <code>ROLE_ANONYMOUS</code>, <code>ROLE_USER</code>, and <code>ROLE_ADMIN</code> are not permitted anymore in the UserController.</p>

<p>This means that the user with the username <code>henry</code> can make 50 requests or requests totalling less than 100 000 characters in 600 seconds to <code>/e-translation/tilde</code> service. Since <code>henry</code> is an authenticated user (and thus has the <code>ROLE_USER</code>), he can also make 50 requests totalling less than 2 000 000 characters to <code>/e-entity/freme-ner/datasets</code>.
An anonymous user (who will be mapped to his IP-Address) can only make 10 requests to <code>/e-entity/freme-ner/datasets</code> totalling 1 000 000 characters in 600 seconds because he has the <code>ROLE_ANONYMOUS</code>.
An admin user can make unlimited requests to any e-service, which can be seen that his number of requests and also his size are set to 0.</p>

  </article>

</div>

	</div>

    
<footer class="footer">

		<div class = "navbar navbar-default navbar-fixed-bottom">
		
			<div class = "container">
				<p class = "navbar-text">FREME is being developed by the FREME Consortium.</p>
					<p class="text-center"><img height="40"  alt="eu-flag"	 width="60" src="http://www.freme-project.eu/wp-content/uploads/2015/02/flag_yellow_high-272x182.jpg"></p>
				<p class="navbar-text">Co-funded by the EC under the H2020 Framework Programme for Research and Innovation | Grant agreement number 644771.</p>
			</div>
			
		</div>
		
</footer>


  </body>

</html>
